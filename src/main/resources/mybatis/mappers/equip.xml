<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.equip">
<!-- 리절트 맵 정의 -->	
	<resultMap id="EquipResult" type="EquipVO">
	    <result property="cate_name" column="cate_name" />
		
		<result property="eq_name" column="eq_name" />
		<result property="eq_img" column="eq_img" />
		<result property="eq_spec" column="eq_spec" />
		<result property="eq_thumimg" column="eq_thumimg" />
		<result property="eq_ma" column="eq_ma" />
		
		<result property="eq_serial" column="eq_serial" />
		<result property="eq_produc" column="eq_produc" />
		<result property="eq_regist" column="eq_regist" />
		<result property="eq_state" column="eq_state" />
		
		<result property="res_num" column="res_num" />
		<result property="res_start" column="res_start" />
		<result property="res_end" column="res_end" />
		<result property="res_Status" column="res_Status" />
		<result property="user_id" column="user_id" />
		
	</resultMap>
	
	
	<!--장비 리스트 -->
	<select id="selectAllEquipList" resultMap="EquipResult"   >
    <![CDATA[
      SELECT Eq_name, Eq_thumimg, Eq_spec, Eq_ma from Equipment	
    ]]>
  </select>
  
  <!--장비 상세페이지뷰 -->
	<select id="EquipDetail" resultType="com.dnb.pro.equip.vo.EquipVO"  parameterType="EquipVO" >
    <![CDATA[
      SELECT * from Equipment	
       where eq_name = #{eq_name}
      
    ]]>
  </select>
  
  <!--장비 이름 조회 -->
   <select id="selectEquipByCode" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT
	count(*) as Eq_name
	FROM
	Equipment
            	]]>
    </select> 
    
     <!--장비 등록 리스트 -->
   <select id="selectAdminEquipList" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT equipment.Cate_name, equipment.eq_name, Eq_list.eq_serial, Eq_list.eq_regist from equipment,Eq_list
    where Eq_list.eq_name = Equipment.eq_name
            	]]>
    </select> 
    
    
    <!-- 장비 상세페이지 사용가능한 장비 수량 조회 
    <select id="selecAmount" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	select COUNT(*) FROM 
(SELECT eq_name, eq_serial,eq_state 
from (select eql.eq_name,eq_serial,eql.eq_state 
    from eq_list eql where eql.eq_state not in '수리' and eql.eq_state not in '폐기') 
        where eq_name= #{eq_name} and eq_serial not in(select eq_serial 
            from reserve where (res_start between #{from} and #{to} or (res_end between #{from}  and #{to})))
            	]]>
    </select> -->
    
     <!--분류명  리스트 -->
   <select id="selectCatenameList" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT Cate_name from category
            	]]>
    </select> 
    
     <!--분류명  등록 -->
   <insert id="insertCatename" parameterType="String">
    <![CDATA[
	insert into category(cate_name) 
	values(#{cate_name}) 
            	]]>
    </insert>
    
     <!--분류명  삭제 -->
   <delete id="deleteCatename" parameterType="String">
    <![CDATA[
	delete from category
	where cate_name = #{cate_name}
	
            	]]>
    </delete>
    
    <!--분류명  조회 -->
     <select id="selectCateByCode" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT
	count(*) as cate_name
	FROM
	category
            	]]>
    </select> 
  
  </mapper>