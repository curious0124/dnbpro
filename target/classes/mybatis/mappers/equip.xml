<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.equip">
<!-- 리절트 맵 정의 -->	
	<resultMap id="EquipResult" type="EquipVO">
	    <result property="cate_name" column="cate_name" />
		
		<result property="eq_name" column="eq_name" />
		<result property="eq_img" column="eq_img" />
		<result property="eq_spec" column="eq_spec" />
		<result property="eq_thumimg" column="eq_thumimg" />
		<result property="eq_ma" column="eq_ma" />
		
		<result property="eq_serial" column="eq_serial" />
		<result property="eq_produc" column="eq_produc" />
		<result property="eq_regist" column="eq_regist" />
		<result property="eq_state" column="eq_state" />
		
		<result property="res_num" column="res_num" />
		<result property="res_start" column="res_start" />
		<result property="res_end" column="res_end" />
		<result property="res_Status" column="res_Status" />
		<result property="user_id" column="user_id" />
		
	</resultMap>
	
	
	<!--장비 리스트 -->
	<select id="selectAllEquipList" resultMap="EquipResult"   >
    <![CDATA[
      SELECT Eq_name, Eq_thumimg, Eq_spec, Eq_ma from Equipment	
    ]]>
  </select>
  
  <!--장비 상세페이지뷰 -->
	<select id="EquipDetail" resultType="com.dnb.pro.equip.vo.EquipVO"  parameterType="EquipVO" >
    <![CDATA[
      SELECT * from Equipment	
       where eq_name = #{eq_name}
      
    ]]>
  </select>
  
  <!--장비 이름 조회 -->
   <select id="selectEquipByCode" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT
	count(*) as Eq_name
	FROM
	Equipment
            	]]>
    </select> 
    
     <!--장비 등록 리스트 -->
   <select id="selectAdminEquipList" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT equipment.Cate_name, equipment.eq_name, Eq_list.eq_serial, Eq_list.eq_regist, eq_state from equipment,Eq_list
    where Eq_list.eq_name = Equipment.eq_name
            	]]>
    </select> 
    
    
    <!-- 장비 상세페이지 사용가능한 장비 수량 조회 
    <select id="selecAmount" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	select COUNT(*) FROM 
(SELECT eq_name, eq_serial,eq_state 
from (select eql.eq_name,eq_serial,eql.eq_state 
    from eq_list eql where eql.eq_state not in '수리' and eql.eq_state not in '폐기') 
        where eq_name= #{eq_name} and eq_serial not in(select eq_serial 
            from reserve where (res_start between #{from} and #{to} or (res_end between #{from}  and #{to})))
            	]]>
    </select> -->
    
     <!--분류명  리스트 -->
   <select id="selectCatenameList" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT Cate_name from category
            	]]>
    </select> 
    
     <!--분류명  등록 -->
   <insert id="insertCatename" parameterType="String">
    <![CDATA[
	insert into category(cate_name) 
	values(#{cate_name}) 
            	]]>
    </insert>
    
     <!--분류명  삭제 -->
   <delete id="deleteCatename">
    <![CDATA[
	delete from category
	where cate_name = #{cate_name}
	
            	]]>
    </delete>
    
    <!--분류명  조회 -->
     <select id="selectCateByCode" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT Cate_name from category
	where cate_name = #{cate_name}
            	]]>
    </select> 
    
      <!--모델명  리스트 -->
   <select id="selectEqnameList" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT cate_name,Eq_name,Eq_ma,Eq_spec from equipment
            	]]>
    </select> 
  
  <!--모델명  조회 -->
     <select id="selectEqnameByCode" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT
	count(*) as eq_name
	FROM
	equipment
            	]]>
    </select> 
    
    <!--모델명  등록 -->
   <insert id="insertEquiplist" parameterType="EquipVO">
    <![CDATA[
	insert into equipment(cate_name,eq_name,eq_ma,eq_spec,eq_img,eq_thumimg) 
	values(#{cate_name},#{eq_name},#{eq_ma},#{eq_spec},#{eq_img},#{eq_thumimg}) 
            	]]>
    </insert>
    
    <!--분류명  모델에서 가져오기  -->
     <select id="selectCateByCode2" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT cate_name FROM equipment
	where cate_name=#{cate_name}
            	]]>
    </select> 
   
    <!--시리얼명 등록 -->
   <insert id="insertSeriallist" parameterType="EquipVO">
    <![CDATA[
	insert into eq_list(eq_name,eq_serial,eq_produc) 
	values(#{eq_name},#{eq_serial},to_date(#{eq_produc, jdbcType=VARCHAR},'yyyy/MM/dd')) 
            	]]>
    </insert>
    
     <!--모델명 가져오기 -->
    <select id="selectonlyEqnameList" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT eq_name from equipment
            	]]>
    </select> 
    
    
    <!--모델명  삭제 -->
   <delete id="deleteEqname">
    <![CDATA[
	delete from Equipment
	where Eq_name = #{eq_name}
	
            	]]>
    </delete>
    
     <!--시리얼명  삭제 -->
   <delete id="deleteEqserial">
    <![CDATA[
	delete from Eq_list
	where eq_serial = #{eq_serial}
	
            	]]>
    </delete>
    
    <!-- 장비 상태창  수정 -->
     <update id="updateSerialState" parameterType="String">
        <![CDATA[
           update eq_list 
           set eq_state=#{eq_state}
           where eq_serial=#{eq_serial}
           ]]>    
     </update>
     
      <!-- 시리얼넘버 가져오기 -->
      <select id="selectSerialById"  resultType="EquipVO"   parameterType="EquipVO" >
	<![CDATA[
		select eq_serial from eq_list	
		where eq_serial=#{eq_serial} 	
	]]>
  </select>
  
   <!--시리얼 상태  리스트 
   <select id="selectStateList" parameterType="EquipVO" resultType="com.dnb.pro.equip.vo.EquipVO">
    <![CDATA[
	SELECT eq_state from eq_list
            	]]>
    </select> 
    -->
  </mapper>